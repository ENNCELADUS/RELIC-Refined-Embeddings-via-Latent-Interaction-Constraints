run_config:
  mode: "train_only"
  seed: 47
  pretrain_run_id: "hpc_e2e_pretrain"
  finetune_run_id: "hpc_e2e_finetune"
  eval_run_id: "hpc_e2e_eval"
  load_checkpoint_path: null
  save_best_only: true

device_config:
  device: "cuda"
  ddp_enabled: true
  use_mixed_precision: true

data_config:
  benchmark:
    name: "PRING"
    root_dir: "data/PRING"
    species: "human"
    split_strategy: "BFS"
    processed_dir: "data/PRING/species_processed_data/human/BFS"
  embeddings:
    source: "esm3"
    cache_dir: "data/embeddings/esm3"
  max_sequence_length: 32
  dataloader:
    train_dataset: "data/PRING/species_processed_data/human/BFS/human_train_ppi.txt"
    valid_dataset: "data/PRING/species_processed_data/human/BFS/human_val_ppi.txt"
    test_dataset: "data/PRING/species_processed_data/human/BFS/human_test_ppi.txt"
    max_samples_per_split: 64
    num_workers: 2
    pin_memory: true
    drop_last: false
    sampling:
      strategy: "ohem"
      warmup_epochs: 1
      keep_ratio: 0.5
      min_keep: 8

model_config:
  model: "v3"
  input_dim: 1536
  d_model: 384
  encoder_layers: 2
  cross_attn_layers: 2
  n_heads: 12
  mlp_head:
    hidden_dims: [256, 128, 64]
    dropout: 0.20
    activation: "gelu"
    norm: "layernorm"
  regularization:
    dropout: 0.15
    token_dropout: 0.10
    cross_attention_dropout: 0.15
    stochastic_depth: 0.10

training_config:
  epochs: 1
  batch_size: 8
  early_stopping_patience: 1
  monitor_metric: "auprc"
  logging:
    validation_metrics: ["auprc", "auroc"]
  optimizer:
    type: "adamw"
    lr: 0.00005
    beta1: 0.9
    beta2: 0.999
    eps: 1.0e-8
    weight_decay: 0.015
  scheduler:
    type: "onecycle"
    max_lr: 0.00005
    pct_start: 0.20
    div_factor: 25
    final_div_factor: 10000
    anneal_strategy: "cos"
  loss:
    type: "bce_with_logits"
    pos_weight: 1.0
    label_smoothing: 0.02
  strategy:
    type: "staged_unfreeze"
    unfreeze_epoch: 1
    initial_trainable_prefixes: ["output_head"]

evaluate:
  metrics:
    - "auroc"
    - "auprc"
    - "accuracy"
    - "sensitivity"
    - "specificity"
    - "precision"
    - "recall"
    - "f1"
    - "mcc"
